<html>
<head>
    <title>wikiracer!</title>

    <link href="../css/reset.css" rel="stylesheet" type="text/css" />
    <link href="../css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css">
    <link href="../css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="../css/game.css" rel="stylesheet" type="text/css">

</head>
<body>

<!-- Give up modal -->
<div class="modal fade" id="giveUpModal" tabindex="-1" role="dialog" aria-labelledby="giveUpLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="giveUpLabel">It's not to late yet!</h4>
      </div>
      <div class="modal-body">
        Are you sure you want to give up just now?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">No</button>
        <button type="button" class="btn btn-primary btn-danger" data-dismiss="modal">Yes</button>
      </div>
    </div>
  </div>
</div>

<div class="page-header">
  <h1>wikiracer! <small>by nemo and krizz</small></h1>
</div>

<div class="row-fluid">
    <div class="span9">
        <h4 id="pageTitle">{{format_wikiurl .Player.LastVisited}}</h4>
        <!-- http://stackoverflow.com/a/9880360/1643939 -->
        <iframe sandbox="allow-forms allow-scripts" name="gameFrame" width="100%" height="80%" src="{{.WikiURL}}"></iframe>
    </div>
    <div class="span3" id="sidebar">
        <h4>Summary of goal page</h4>
        <p>{{.Summary}}</p>

        <hr />

        <b>Start:</b><br />
        {{format_wikiurl .Game.Start}}<br /><br />
        <b>Goal:</b><br />
        {{format_wikiurl .Game.Goal}}<br /><br />

        <b>Players:</b><br />
		<ol id="players">
			{{with $data := .}}{{range $index, $player := .Game.SortedPlayers}}
				{{if eq $data.Player.Name .Name}}
				<li data-player="{{.Name}}">{{.Name}} (you)
				{{else}}
				<li data-player="{{.Name}}">{{.Name}}
				{{end}}

				{{with $isTempWinner := is_temporary_winner $data.Game $player}}
					{{with $isWinner := is_winner $data.Game $player}}
						<span title="Winner!" class="winflag badge badge-important">⚑</span>
					{{else}}
						<span title="Winner for now! Go for it!" class="winflag badge badge-warning">⚑</span>
					{{end}}
				{{end}}

				{{if eq $index 0}}
				<span class="badge badge-success visits">{{len .Path}}</span>
				{{else}}
				<span class="badge visits">{{len .Path}}</span>
				{{end}}
				</li>
			{{end}}{{end}}
        </ol>

        <hr />
        <b>Log</b>
        <ol id="log">
        </ol>

		<hr />

		<button class="btn btn-danger" data-toggle="modal" data-target="#giveUpModal">
			Give up!
		</button>
    </div>
</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
<script src="../js/wiki.js"></script>
<script src="../js/bootstrap.min.js"></script>
</body>
</html>

